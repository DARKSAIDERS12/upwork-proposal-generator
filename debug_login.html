<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Login - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—Ö–æ–¥–∞</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        button { padding: 10px 20px; margin: 5px; }
        input { padding: 8px; margin: 5px; width: 200px; }
        .log { background: #f8f9fa; padding: 10px; margin: 10px 0; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã –≤—Ö–æ–¥–∞</h1>
    
    <div class="debug-section info">
        <h3>üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h3>
        <ol>
            <li>–û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12 ‚Üí Console)</li>
            <li>–ù–∞–∂–º–∏—Ç–µ "–¢–µ—Å—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤" –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ HTML</li>
            <li>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–æ–π—Ç–∏ —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏</li>
            <li>–°–ª–µ–¥–∏—Ç–µ –∑–∞ –ª–æ–≥–∞–º–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏</li>
        </ol>
    </div>
    
    <div class="debug-section">
        <h3>üß™ –¢–µ—Å—Ç HTML —ç–ª–µ–º–µ–Ω—Ç–æ–≤:</h3>
        <button onclick="testHTMLElements()">–¢–µ—Å—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤</button>
        <div id="htmlTestResult" class="log"></div>
    </div>
    
    <div class="debug-section">
        <h3>üîê –¢–µ—Å—Ç –≤—Ö–æ–¥–∞:</h3>
        <form id="testLoginForm">
            <input type="email" id="testEmail" placeholder="test@example.com" value="test@example.com">
            <input type="password" id="testPassword" placeholder="password" value="testpass123">
            <button type="submit">–¢–µ—Å—Ç –≤—Ö–æ–¥–∞</button>
        </form>
        <div id="loginTestResult" class="log"></div>
    </div>
    
    <div class="debug-section">
        <h3>üß™ –¢–µ—Å—Ç—ã:</h3>
        <button onclick="testShowMainContent()">–¢–µ—Å—Ç showMainContent()</button>
        <button onclick="testShowMainContentLogic()">–¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è</button>
        <button onclick="createTestElements()">–°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã</button>
        <button onclick="checkVariables()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ</button>
        <div id="variablesStatus" class="log"></div>
    </div>
    
    <div class="debug-section">
        <h3>üîó –°—Å—ã–ª–∫–∏:</h3>
        <a href="index.html" target="_blank">–û—Ç–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∞–π—Ç</a>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        let currentUser = null;
        let isAuthenticated = false;
        
        // –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logDiv = document.createElement('div');
            logDiv.innerHTML = `[${timestamp}] ${message}`;
            logDiv.className = type;
            console.log(message);
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            if (type === 'error') {
                document.getElementById('loginTestResult').appendChild(logDiv);
            } else if (type === 'success') {
                document.getElementById('htmlTestResult').appendChild(logDiv);
            } else {
                document.getElementById('variablesStatus').appendChild(logDiv);
            }
        }
        
        // –¢–µ—Å—Ç HTML —ç–ª–µ–º–µ–Ω—Ç–æ–≤
        function testHTMLElements() {
            log('üß™ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç HTML —ç–ª–µ–º–µ–Ω—Ç–æ–≤...', 'info');
            
            const elements = [
                'authForms',
                'mainApp', 
                'userInfo',
                'userEmail',
                'loginForm',
                'registerForm'
            ];
            
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    log(`‚úÖ ${id}: –Ω–∞–π–¥–µ–Ω`, 'success');
                    log(`   - display: ${element.style.display}`, 'info');
                    log(`   - visible: ${element.offsetParent !== null}`, 'info');
                } else {
                    log(`‚ùå ${id}: –ù–ï –ù–ê–ô–î–ï–ù`, 'error');
                }
            });
            
            log('üéØ –¢–µ—Å—Ç HTML —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω', 'success');
        }
        
        // –¢–µ—Å—Ç –≤—Ö–æ–¥–∞
        function testLogin() {
            log('üîê –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç –≤—Ö–æ–¥–∞...', 'info');
            
            const email = document.getElementById('testEmail').value;
            const password = document.getElementById('testPassword').value;
            
            log(`üìß Email: ${email}`, 'info');
            log(`üîë Password: ${password}`, 'info');
            
            // –°–∏–º—É–ª–∏—Ä—É–µ–º —É—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥
            setTimeout(() => {
                log('‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ (—Å–∏–º—É–ª—è—Ü–∏—è)', 'success');
                
                // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                currentUser = {
                    email: email,
                    id: 'test-user-123',
                    created_at: new Date().toISOString()
                };
                isAuthenticated = true;
                
                log(`üë§ currentUser: ${JSON.stringify(currentUser)}`, 'success');
                log(`üîê isAuthenticated: ${isAuthenticated}`, 'success');
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
                testShowMainContent();
                
            }, 1000);
        }
        
        // –¢–µ—Å—Ç —Ñ—É–Ω–∫—Ü–∏–∏ showMainContent
        function testShowMainContent() {
            log('üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º showMainContent()...', 'info');
            
            try {
                // –í–º–µ—Å—Ç–æ iframe –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º—É—é –ø—Ä–æ–≤–µ—Ä–∫—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
                log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ:', 'info');
                
                const elements = [
                    'authForms',
                    'mainApp', 
                    'userInfo',
                    'userEmail',
                    'loginForm',
                    'registerForm'
                ];
                
                let foundElements = 0;
                elements.forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        log(`‚úÖ ${id}: –Ω–∞–π–¥–µ–Ω`, 'success');
                        log(`   - display: ${element.style.display}`, 'info');
                        log(`   - visible: ${element.offsetParent !== null}`, 'info');
                        foundElements++;
                    } else {
                        log(`‚ùå ${id}: –ù–ï –ù–ê–ô–î–ï–ù`, 'error');
                    }
                });
                
                log(`üìä –ù–∞–π–¥–µ–Ω–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤: ${foundElements}/${elements.length}`, 'info');
                
                if (foundElements === elements.length) {
                    log('‚úÖ –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã!', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
                    log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è...', 'info');
                    
                    // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
                    createTestElements();
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º showMainContent
                    testShowMainContentLogic();
                    
                } else {
                    log('‚ùå –ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞–π–¥–µ–Ω—ã', 'error');
                    log('üí° –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã...', 'info');
                    createTestElements();
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –≤ testShowMainContent: ${error.message}`, 'error');
            }
        }
        
        // –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        function createTestElements() {
            log('üî® –°–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã...', 'info');
            
            // –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            let testContainer = document.getElementById('testElements');
            if (!testContainer) {
                testContainer = document.createElement('div');
                testContainer.id = 'testElements';
                testContainer.className = 'debug-section';
                testContainer.innerHTML = '<h3>üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã</h3>';
                document.body.appendChild(testContainer);
            }
            
            // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç
            if (!document.getElementById('authForms')) {
                const authForms = document.createElement('div');
                authForms.id = 'authForms';
                authForms.innerHTML = '<p>üîê –§–æ—Ä–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (—Ç–µ—Å—Ç)</p>';
                testContainer.appendChild(authForms);
                log('‚úÖ –°–æ–∑–¥–∞–Ω authForms', 'success');
            }
            
            if (!document.getElementById('mainApp')) {
                const mainApp = document.createElement('div');
                mainApp.id = 'mainApp';
                mainApp.innerHTML = '<p>üéâ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç (—Ç–µ—Å—Ç)</p>';
                mainApp.style.display = 'none';
                testContainer.appendChild(mainApp);
                log('‚úÖ –°–æ–∑–¥–∞–Ω mainApp', 'success');
            }
            
            if (!document.getElementById('userInfo')) {
                const userInfo = document.createElement('div');
                userInfo.id = 'userInfo';
                userInfo.innerHTML = '<p>üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–µ—Å—Ç)</p>';
                testContainer.appendChild(userInfo);
                log('‚úÖ –°–æ–∑–¥–∞–Ω userInfo', 'success');
            }
            
            if (!document.getElementById('userEmail')) {
                const userEmail = document.createElement('span');
                userEmail.id = 'userEmail';
                userEmail.textContent = 'test@example.com';
                testContainer.appendChild(userEmail);
                log('‚úÖ –°–æ–∑–¥–∞–Ω userEmail', 'success');
            }
            
            log('üéØ –¢–µ—Å—Ç–æ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã', 'success');
        }
        
        // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É showMainContent
        function testShowMainContentLogic() {
            log('üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É showMainContent...', 'info');
            
            try {
                const authForms = document.getElementById('authForms');
                const mainApp = document.getElementById('mainApp');
                const userInfo = document.getElementById('userInfo');
                const userEmail = document.getElementById('userEmail');
                
                if (authForms && mainApp && userInfo && userEmail) {
                    log('‚úÖ –í—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–∫—Ä—ã—Ç–∏–µ —Ñ–æ—Ä–º
                    authForms.style.display = 'none';
                    log('‚úÖ authForms —Å–∫—Ä—ã—Ç', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∫–∞–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
                    mainApp.style.display = 'block';
                    log('‚úÖ mainApp –ø–æ–∫–∞–∑–∞–Ω', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∫–∞–∑ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    userInfo.style.display = 'block';
                    log('‚úÖ userInfo –ø–æ–∫–∞–∑–∞–Ω', 'success');
                    
                    // –¢–µ—Å—Ç–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ email
                    if (currentUser) {
                        userEmail.textContent = currentUser.email;
                        log(`‚úÖ userEmail –æ–±–Ω–æ–≤–ª–µ–Ω: ${userEmail.textContent}`, 'success');
                    }
                    
                    log('üéâ –õ–æ–≥–∏–∫–∞ showMainContent –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ!', 'success');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
                    setTimeout(() => {
                        log('üîÑ –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ...', 'info');
                        authForms.style.display = 'block';
                        mainApp.style.display = 'none';
                        userInfo.style.display = 'none';
                        log('‚úÖ –ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'success');
                    }, 3000);
                    
                } else {
                    log('‚ùå –ù–µ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'error');
                }
                
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –≤ testShowMainContentLogic: ${error.message}`, 'error');
            }
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
        function checkVariables() {
            log('üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ...', 'info');
            log(`üë§ currentUser: ${currentUser ? JSON.stringify(currentUser) : 'null'}`, 'info');
            log(`üîê isAuthenticated: ${isAuthenticated}`, 'info');
            log(`üåê window.location: ${window.location.href}`, 'info');
            log(`üìÑ document.title: ${document.title}`, 'info');
        }
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
        document.getElementById('testLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            testLogin();
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'success');
        log('üìã –ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é', 'info');
    </script>
</body>
</html>
