<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https: http:; script-src 'self' 'unsafe-inline' 'unsafe-eval' https: http:; style-src 'self' 'unsafe-inline' https: http:; img-src 'self' data: https: http:; font-src 'self' https: http:; connect-src 'self' https: http:;">
    <title>Upwork Proposal Generator - –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <h1>üöÄ Upwork Proposal Generator</h1>
                <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é AI</p>
            </div>
            <div class="user-info" id="userInfo" style="display: none;">
                <span id="userEmail"></span>
                <a href="subscription_manager.html" class="btn-secondary">‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π</a>
                <a href="yandex_gpt_setup.html" class="btn-secondary">ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API</a>
                <button onclick="handleLogout()" class="btn-secondary">–í—ã–π—Ç–∏</button>
            </div>
        </header>

        <!-- Auth Forms -->
        <div id="authForms" class="auth-section">
            <div class="auth-container">
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
                <div id="loadingIndicator" class="loading-indicator" style="display: none;">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏...</p>
                </div>
                
                <div class="auth-tabs">
                    <button class="tab-btn active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="tab-btn" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                
                <!-- Quick Links -->
                <div class="quick-links">
                    <a href="subscription_manager.html" class="quick-link">üí∞ –¢–∞—Ä–∏—Ñ—ã –∏ –ø–æ–¥–ø–∏—Å–∫–∏</a>
                    <a href="yandex_gpt_setup.html" class="quick-link">ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex GPT</a>
                </div>
                
                <!-- GitHub Login Button -->
                <div class="github-login">
                    <button class="github-btn" id="githubLoginBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24">
                            <path fill="currentColor" d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                        </svg>
                        –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ GitHub
                    </button>
                    <div class="divider">–∏–ª–∏</div>
                </div>
                
                <!-- Login Form -->
                <div id="loginForm" class="auth-form">
                    <h2>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
                    <form id="loginFormElement">
                        <div class="form-group">
                            <label for="loginEmail">Email:</label>
                            <input type="email" id="loginEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="loginPassword">–ü–∞—Ä–æ–ª—å:</label>
                            <input type="password" id="loginPassword" required>
                        </div>
                        <button type="submit" class="btn-primary">–í–æ–π—Ç–∏</button>
                    </form>
                </div>
                
                <!-- Register Form -->
                <div id="registerForm" class="auth-form" style="display: none;">
                    <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
                    <form id="registerFormElement">
                        <div class="form-group">
                            <label for="registerEmail">Email:</label>
                            <input type="email" id="registerEmail" required>
                        </div>
                        <div class="form-group">
                            <label for="registerPassword">–ü–∞—Ä–æ–ª—å (–º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤):</label>
                            <input type="password" id="registerPassword" required minlength="6">
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å:</label>
                            <input type="password" id="confirmPassword" required>
                        </div>
                        <button type="submit" class="btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Main App -->
        <div id="mainApp" class="main-app" style="display: none;">
            <!-- Subscription Status -->
            <div class="subscription-status" id="subscriptionStatus">
                <div class="subscription-info">
                    <h3>üí≥ –í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞</h3>
                    <div class="subscription-details">
                        <span id="subscriptionType">–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è (–î–µ–º–æ)</span>
                        <span id="aiProvider">AI: –î–µ–º–æ-—Ä–µ–∂–∏–º</span>
                        <span id="dailyRemaining">–û—Å—Ç–∞–ª–æ—Å—å: 3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</span>
                    </div>
                    <div id="subscriptionInfo"></div>
                </div>
                <div class="subscription-actions">
                    <button onclick="openSubscriptionManager()" class="btn-upgrade" id="upgradeBtn">
                        üíé Yandex GPT Premium
                    </button>
                    <button onclick="setupYandexGPTAPI()" class="btn-secondary" id="setupBtn" style="display: none;">
                        ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å API
                    </button>
                </div>
            </div>

            <!-- Proposal Generator -->
            <div class="generator-section">
                <h2>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</h2>
                <form id="proposalForm" onsubmit="generateProposal(event)">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="projectTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:</label>
                            <input type="text" id="projectTitle" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Website Development">
                        </div>
                        <div class="form-group">
                            <label for="projectBudget">–ë—é–¥–∂–µ—Ç:</label>
                            <input type="text" id="projectBudget" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: $1000-2000">
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="projectDescription">–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞:</label>
                        <textarea id="projectDescription" required placeholder="–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç –ø–æ–¥—Ä–æ–±–Ω–æ..."></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="specialization">–°–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:</label>
                            <select id="specialization" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é</option>
                                <option value="Web Development">–í–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</option>
                                <option value="Mobile Development">–ú–æ–±–∏–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞</option>
                                <option value="Graphic Design">–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω</option>
                                <option value="Content Writing">–ù–∞–ø–∏—Å–∞–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞</option>
                                <option value="Digital Marketing">–¶–∏—Ñ—Ä–æ–≤–æ–π –º–∞—Ä–∫–µ—Ç–∏–Ω–≥</option>
                                <option value="Data Entry">–í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö</option>
                                <option value="Translation">–ü–µ—Ä–µ–≤–æ–¥</option>
                                <option value="Virtual Assistant">–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –ø–æ–º–æ—â–Ω–∏–∫</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="tone">–¢–æ–Ω –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è:</label>
                            <select id="tone" required>
                                <option value="Professional">–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π</option>
                                <option value="Friendly">–î—Ä—É–∂–µ–ª—é–±–Ω—ã–π</option>
                                <option value="Formal">–§–æ—Ä–º–∞–ª—å–Ω—ã–π</option>
                                <option value="Creative">–ö—Ä–µ–∞—Ç–∏–≤–Ω—ã–π</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn-generate">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ</button>
                </form>
            </div>

            <!-- Generated Proposal -->
            <div id="proposalResult" class="proposal-result" style="display: none;">
                <h3>–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ:</h3>
                <div class="proposal-content" id="proposalContent"></div>
                <div class="proposal-actions">
                    <button onclick="copyProposal()" class="btn-secondary">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                    <button onclick="saveProposal()" class="btn-secondary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button onclick="generateNew()" class="btn-primary">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ</button>
                </div>
            </div>

            <!-- Proposals History -->
            <div class="history-section">
                <h3>–ò—Å—Ç–æ—Ä–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π</h3>
                <div id="proposalsHistory" class="proposals-list">
                    <!-- –ò—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- Upgrade Modal -->
        <div id="upgradeModal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close" onclick="closeUpgradeModal()">&times;</span>
                <h2>–û–±–Ω–æ–≤–∏—Ç–µ –¥–æ Premium</h2>
                
                <div class="pricing-cards">
                    <div class="pricing-card">
                        <h3>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –≤–µ—Ä—Å–∏—è</h3>
                        <div class="price">0 ‚ÇΩ</div>
                        <ul>
                            <li>3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –≤ –¥–µ–Ω—å</li>
                            <li>–ë–∞–∑–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã</li>
                            <li>–î–µ–º–æ-—Ä–µ–∂–∏–º AI</li>
                        </ul>
                    </div>
                    <div class="pricing-card premium">
                        <h3>Premium</h3>
                        <div class="price">299 ‚ÇΩ/–º–µ—Å</div>
                        <ul>
                            <li>–ù–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</li>
                            <li>Yandex GPT API</li>
                            <li>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —à–∞–±–ª–æ–Ω—ã</li>
                            <li>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞</li>
                        </ul>
                        <button onclick="upgradeToPremium()" class="btn-upgrade">–û–±–Ω–æ–≤–∏—Ç—å—Å—è</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
    <div id="notifications"></div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentUser = null;
        let isAuthenticated = false;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
        function showNotification(message, type = 'info') {
            const notifications = document.getElementById('notifications');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            notifications.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 5000);
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        function showLoadingIndicator() {
            document.getElementById('loadingIndicator').style.display = 'flex';
        }

        function hideLoadingIndicator() {
            document.getElementById('loadingIndicator').style.display = 'none';
        }

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
        function showTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ñ–æ—Ä–º—ã
            document.querySelectorAll('.auth-form').forEach(form => {
                form.style.display = 'none';
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—É—é —Ñ–æ—Ä–º—É –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É
            document.getElementById(tabName + 'Form').style.display = 'block';
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        async function handleRegister(event) {
            event.preventDefault();
            
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (!email || !password || !confirmPassword) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è
            if (password.length < 6) {
                showNotification('‚ùå –ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤', 'error');
                return;
            }
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
            if (password !== confirmPassword) {
                showNotification('‚ùå –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç', 'error');
                return;
            }
            
            showLoadingIndicator();
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ auth.js –∑–∞–≥—Ä—É–∂–µ–Ω
                if (typeof registerUser === 'undefined') {
                    showNotification('‚è≥ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.', 'info');
                    return;
                }
                
                showNotification('üîÑ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º...', 'info');
                const user = await registerUser(email, password, email);
                
                hideLoadingIndicator();
                showNotification('‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ email –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è.', 'success');
                console.log('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', user);
                
                // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –≤—Ö–æ–¥–∞
                showTab('login');
                
            } catch (error) {
                hideLoadingIndicator();
                showNotification('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏:', error);
            }
        }

        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Ö–æ–¥–∞
        async function handleLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            showLoadingIndicator();
            
            try {
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ auth.js –∑–∞–≥—Ä—É–∂–µ–Ω
                if (typeof loginUser === 'undefined') {
                    showNotification('‚è≥ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.', 'info');
                    return;
                }
                
                showNotification('üîÑ –í—Ö–æ–¥–∏–º...', 'info');
                const user = await loginUser(email, password);
                
                hideLoadingIndicator();
                showNotification('‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω!', 'success');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
                currentUser = user;
                isAuthenticated = true;
                showMainContent();
                
            } catch (error) {
                hideLoadingIndicator();
                showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞:', error);
            }
        }

        // GitHub –≤—Ö–æ–¥
        async function handleGitHubLogin() {
            try {
                if (typeof signInWithGitHub === 'undefined') {
                    showNotification('‚è≥ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ü–æ–¥–æ–∂–¥–∏—Ç–µ –Ω–µ–º–Ω–æ–≥–æ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.', 'info');
                    return;
                }
                
                showNotification('üîÑ –í—Ö–æ–¥–∏–º —á–µ—Ä–µ–∑ GitHub...', 'info');
                await signInWithGitHub();
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ GitHub: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞ GitHub –≤—Ö–æ–¥–∞:', error);
            }
        }

        // –í—ã—Ö–æ–¥
        async function handleLogout() {
            try {
                if (typeof logoutUser === 'undefined') {
                    showNotification('‚è≥ –°–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞.', 'info');
                    return;
                }
                
                await logoutUser();
                currentUser = null;
                isAuthenticated = false;
                hideMainContent();
                showNotification('‚úÖ –í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã', 'success');
                
            } catch (error) {
                showNotification('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞:', error);
            }
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        function showMainContent() {
            document.getElementById('authForms').style.display = 'none';
            document.getElementById('mainApp').style.display = 'block';
            document.getElementById('userInfo').style.display = 'block';
            document.getElementById('userEmail').textContent = currentUser?.email || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
        }

        // –°–∫—Ä—ã–≤–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç
        function hideMainContent() {
            document.getElementById('authForms').style.display = 'block';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('userInfo').style.display = 'none';
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è (–¥–µ–º–æ-—Ä–µ–∂–∏–º)
        function generateProposal(event) {
            event.preventDefault();
            
            const title = document.getElementById('projectTitle').value;
            const budget = document.getElementById('projectBudget').value;
            const description = document.getElementById('projectDescription').value;
            const specialization = document.getElementById('specialization').value;
            const tone = document.getElementById('tone').value;
            
            if (!title || !budget || !description || !specialization || !tone) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è', 'error');
                return;
            }
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–µ–º–æ-–ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
            const proposal = `–£–≤–∞–∂–∞–µ–º—ã–π –∫–ª–∏–µ–Ω—Ç!

–Ø –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω –≤ –≤–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ "${title}" —Å –±—é–¥–∂–µ—Ç–æ–º ${budget}.

${description}

–ö–∞–∫ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –≤ –æ–±–ª–∞—Å—Ç–∏ ${specialization}, —è –≥–æ—Ç–æ–≤ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ –∏ –≤ —Å—Ä–æ–∫. –ú–æ–π –ø–æ–¥—Ö–æ–¥ ${tone.toLowerCase()} –∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π.

–° —É–≤–∞–∂–µ–Ω–∏–µ–º,
${currentUser?.email || '–í–∞—à —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç'}`;
            
            document.getElementById('proposalContent').textContent = proposal;
            document.getElementById('proposalResult').style.display = 'block';
            
            showNotification('‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ!', 'success');
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        function copyProposal() {
            const proposal = document.getElementById('proposalContent').textContent;
            navigator.clipboard.writeText(proposal).then(() => {
                showNotification('‚úÖ –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            }).catch(() => {
                showNotification('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å', 'error');
            });
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        function saveProposal() {
            showNotification('üíæ –§—É–Ω–∫—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è
        function generateNew() {
            document.getElementById('proposalResult').style.display = 'none';
            document.getElementById('proposalForm').reset();
            showNotification('üîÑ –§–æ—Ä–º–∞ –æ—á–∏—â–µ–Ω–∞, –≥–æ—Ç–æ–≤–æ –∫ –Ω–æ–≤–æ–º—É –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—é', 'info');
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–æ–¥–ø–∏—Å–æ–∫
        function openSubscriptionManager() {
            window.open('subscription_manager.html', '_blank');
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Yandex GPT API
        function setupYandexGPTAPI() {
            window.open('yandex_gpt_setup.html', '_blank');
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function openUpgradeModal() {
            document.getElementById('upgradeModal').style.display = 'block';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        function closeUpgradeModal() {
            document.getElementById('upgradeModal').style.display = 'none';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ Premium
        function upgradeToPremium() {
            showNotification('üíé –§—É–Ω–∫—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
            closeUpgradeModal();
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
            document.getElementById('registerFormElement').addEventListener('submit', handleRegister);
            
            // –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞
            document.getElementById('loginFormElement').addEventListener('submit', handleLogin);
            
            // GitHub –≤—Ö–æ–¥
            document.getElementById('githubLoginBtn').addEventListener('click', handleGitHubLogin);
            
            // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    showTab(btn.dataset.tab);
                });
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ Supabase SDK
        async function loadSupabaseSDK() {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
                
                script.onload = () => {
                    console.log('‚úÖ Supabase SDK –∑–∞–≥—Ä—É–∂–µ–Ω —Å cdn.jsdelivr.net');
                    resolve();
                };
                
                script.onerror = () => {
                    console.log('‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å cdn.jsdelivr.net, –ø—Ä–æ–±—É–µ–º unpkg.com');
                    
                    const fallbackScript = document.createElement('script');
                    fallbackScript.src = 'https://unpkg.com/@supabase/supabase-js@2';
                    
                    fallbackScript.onload = () => {
                        console.log('‚úÖ Supabase SDK –∑–∞–≥—Ä—É–∂–µ–Ω —Å unpkg.com');
                        resolve();
                    };
                    
                    fallbackScript.onerror = () => {
                        console.error('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Supabase SDK');
                        reject(new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å Supabase SDK'));
                    };
                    
                    document.head.appendChild(fallbackScript);
                };
                
                document.head.appendChild(script);
            });
        }

        // –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        async function initializeApp() {
            try {
                showLoadingIndicator();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º Supabase SDK
                await loadSupabaseSDK();
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º auth.js
                const authScript = document.createElement('script');
                authScript.src = 'auth.js';
                document.body.appendChild(authScript);
                
                // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ auth.js
                await new Promise((resolve) => {
                    const checkAuth = setInterval(() => {
                        if (typeof registerUser !== 'undefined' && 
                            typeof loginUser !== 'undefined' && 
                            typeof logoutUser !== 'undefined') {
                            clearInterval(checkAuth);
                            console.log('‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ auth.js –∑–∞–≥—Ä—É–∂–µ–Ω—ã');
                            resolve();
                        }
                    }, 100);
                    
                    // –¢–∞–π–º–∞—É—Ç —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
                    setTimeout(() => {
                        clearInterval(checkAuth);
                        console.warn('‚ö†Ô∏è –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è auth.js');
                        resolve();
                    }, 10000);
                });
                
                // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
                setupEventListeners();
                
                hideLoadingIndicator();
                showNotification('‚úÖ –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–∞–±–æ—Ç–µ!', 'success');
                
            } catch (error) {
                hideLoadingIndicator();
                showNotification('‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: ' + error.message, 'error');
                console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:', error);
            }
        }

        // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', initializeApp);
    </script>
</body>
</html>
