<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Supabase SDK</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .debug-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        .log { background: #f8f9fa; padding: 10px; border-radius: 3px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Supabase SDK</h1>
    
    <div class="debug-section info">
        <h3>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–æ–º–æ–∂–µ—Ç –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞–≥—Ä—É–∑–∫–æ–π Supabase SDK.</p>
        <p><strong>–¢–µ–∫—É—â–∏–π URL:</strong> <span id="currentUrl"></span></p>
    </div>

    <div class="debug-section">
        <h3>üöÄ –¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ Supabase SDK</h3>
        <button onclick="testSupabaseLoading()">–¢–µ—Å—Ç –∑–∞–≥—Ä—É–∑–∫–∏ SDK</button>
        <button onclick="testAlternativeCDN()">–¢–µ—Å—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ CDN</button>
        <div id="sdkTest" class="log"></div>
    </div>

    <div class="debug-section">
        <h3>üîê –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞</h3>
        <button onclick="testClientCreation()">–¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞</button>
        <div id="clientTest" class="log"></div>
    </div>

    <div class="debug-section">
        <h3>üåê –¢–µ—Å—Ç —Å–µ—Ç–µ–≤–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è</h3>
        <button onclick="testNetworkConnection()">–¢–µ—Å—Ç —Å–µ—Ç–∏</button>
        <div id="networkTest" class="log"></div>
    </div>

    <div class="debug-section">
        <h3>üì± –û—Ç–∫—Ä—ã—Ç—å –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</h3>
        <button onclick="openMainPage()">–û—Ç–∫—Ä—ã—Ç—å index.html</button>
        <p><em>–û—Ç–∫—Ä–æ–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è</em></p>
    </div>

    <script>
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π URL
        document.getElementById('currentUrl').textContent = window.location.href;

        function log(elementId, message) {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            element.textContent += `[${timestamp}] ${message}\n`;
            element.scrollTop = element.scrollHeight;
        }

        function testSupabaseLoading() {
            const logElement = document.getElementById('sdkTest');
            logElement.textContent = '';
            
            log(logElement, 'üîç –¢–µ—Å—Ç–∏—Ä—É–µ–º –∑–∞–≥—Ä—É–∑–∫—É Supabase SDK...');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
            if (typeof window.supabase !== 'undefined') {
                log(logElement, '‚úÖ window.supabase —É–∂–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                log(logElement, `üì¶ –í–µ—Ä—Å–∏—è: ${window.supabase?.version || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞'}`);
            } else {
                log(logElement, '‚ùå window.supabase –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
            }
            
            if (typeof createClient !== 'undefined') {
                log(logElement, '‚úÖ createClient –¥–æ—Å—Ç—É–ø–µ–Ω');
            } else {
                log(logElement, '‚ùå createClient –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
            }
            
            // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK
            log(logElement, 'üîÑ –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK...');
            
            const script = document.createElement('script');
            script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
            script.onload = () => {
                log(logElement, '‚úÖ SDK –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                if (typeof window.supabase !== 'undefined') {
                    log(logElement, '‚úÖ window.supabase –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏');
                }
                if (typeof createClient !== 'undefined') {
                    log(logElement, '‚úÖ createClient –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏');
                }
            };
            script.onerror = (error) => {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ SDK: ${error}`);
            };
            
            document.head.appendChild(script);
        }

        function testAlternativeCDN() {
            const logElement = document.getElementById('sdkTest');
            log(logElement, 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN...');
            
            const script = document.createElement('script');
            script.src = 'https://unpkg.com/@supabase/supabase-js@2';
            script.onload = () => {
                log(logElement, '‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
            };
            script.onerror = (error) => {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ CDN: ${error}`);
            };
            
            document.head.appendChild(script);
        }

        function testClientCreation() {
            const logElement = document.getElementById('clientTest');
            logElement.textContent = '';
            
            log(logElement, 'üîê –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ Supabase –∫–ª–∏–µ–Ω—Ç–∞...');
            
            if (typeof window.supabase === 'undefined') {
                log(logElement, '‚ùå window.supabase –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                return;
            }
            
            try {
                const supabaseUrl = 'https://xykhpnksatwipwcmxwyn.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5a2hwbmtzYXR3aXB3Y214d3luIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyNTAyNjIsImV4cCI6MjA3MDgyNjI2Mn0.PSARsuv14dI7xq35xvgVoxwjptb4cm8Ywb3bYZhY0KM';
                
                log(logElement, 'üîÑ –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç...');
                const client = window.supabase.createClient(supabaseUrl, supabaseKey);
                
                log(logElement, '‚úÖ –ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ');
                log(logElement, `üìä –¢–∏–ø –∫–ª–∏–µ–Ω—Ç–∞: ${typeof client}`);
                log(logElement, `üîë URL: ${supabaseUrl}`);
                
                // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å
                log(logElement, 'üîÑ –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ...');
                client.from('user_profiles').select('count').limit(1)
                    .then(result => {
                        if (result.error) {
                            log(logElement, `‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${result.error.message}`);
                        } else {
                            log(logElement, '‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ —É—Å–ø–µ—à–Ω–æ');
                        }
                    })
                    .catch(error => {
                        log(logElement, `‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø—Ä–æ—Å–∞: ${error.message}`);
                    });
                
            } catch (error) {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞: ${error.message}`);
            }
        }

        function testNetworkConnection() {
            const logElement = document.getElementById('networkTest');
            logElement.textContent = '';
            
            log(logElement, 'üåê –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ...');
            
            // –¢–µ—Å—Ç 1: CDN Supabase
            fetch('https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2')
                .then(response => {
                    if (response.ok) {
                        log(logElement, '‚úÖ CDN Supabase –¥–æ—Å—Ç—É–ø–µ–Ω');
                    } else {
                        log(logElement, `‚ùå CDN Supabase –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${response.status}`);
                    }
                })
                .catch(error => {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞ CDN Supabase: ${error.message}`);
                });
            
            // –¢–µ—Å—Ç 2: –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN
            fetch('https://unpkg.com/@supabase/supabase-js@2')
                .then(response => {
                    if (response.ok) {
                        log(logElement, '‚úÖ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN –¥–æ—Å—Ç—É–ø–µ–Ω');
                    } else {
                        log(logElement, `‚ùå –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π CDN –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: ${response.status}`);
                    }
                })
                .catch(error => {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ CDN: ${error.message}`);
                });
            
            // –¢–µ—Å—Ç 3: Supabase API
            fetch('https://xykhpnksatwipwcmxwyn.supabase.co/rest/v1/')
                .then(response => {
                    if (response.status === 401) {
                        log(logElement, '‚úÖ Supabase API –¥–æ—Å—Ç—É–ø–µ–Ω (401 - –æ–∂–∏–¥–∞–µ–º–æ –±–µ–∑ –∫–ª—é—á–∞)');
                    } else {
                        log(logElement, `‚ö†Ô∏è Supabase API –æ—Ç–≤–µ—Ç: ${response.status}`);
                    }
                })
                .catch(error => {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞ Supabase API: ${error.message}`);
                });
        }

        function openMainPage() {
            window.open('index.html', '_blank');
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', () => {
            log('sdkTest', 'üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ç–µ—Å—Ç –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ...');
            setTimeout(() => {
                testSupabaseLoading();
            }, 1000);
        });
    </script>
</body>
</html>
