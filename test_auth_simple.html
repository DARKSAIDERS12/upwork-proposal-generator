<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #ddd; border-radius: 5px; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
        .info { background-color: #d1ecf1; border-color: #bee5eb; }
        .log { background: #f8f9fa; padding: 10px; border-radius: 3px; margin: 10px 0; font-family: monospace; white-space: pre-wrap; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        input { padding: 8px; margin: 5px; width: 200px; }
        .form-group { margin: 10px 0; }
    </style>
</head>
<body>
    <h1>üß™ –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ Supabase</h1>
    
    <div class="test-section info">
        <h3>üìã –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –±–µ–∑ —Å–ª–æ–∂–Ω–æ–π –ª–æ–≥–∏–∫–∏.</p>
        <p><strong>URL:</strong> <span id="currentUrl"></span></p>
    </div>

    <div class="test-section">
        <h3>üöÄ –ó–∞–≥—Ä—É–∑–∫–∞ Supabase SDK</h3>
        <button onclick="loadSupabase()">–ó–∞–≥—Ä—É–∑–∏—Ç—å Supabase SDK</button>
        <div id="sdkStatus" class="log"></div>
    </div>

    <div class="test-section">
        <h3>üîê –¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</h3>
        <div class="form-group">
            <label>Email:</label><br>
            <input type="email" id="regEmail" value="test@example.com" placeholder="test@example.com">
        </div>
        <div class="form-group">
            <label>–ü–∞—Ä–æ–ª—å:</label><br>
            <input type="password" id="regPassword" value="TestPassword123!" placeholder="TestPassword123!">
        </div>
        <button onclick="testRegistration()">–¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</button>
        <div id="regResult" class="log"></div>
    </div>

    <div class="test-section">
        <h3>üîë –¢–µ—Å—Ç –≤—Ö–æ–¥–∞</h3>
        <div class="form-group">
            <label>Email:</label><br>
            <input type="email" id="loginEmail" value="test@example.com" placeholder="test@example.com">
        </div>
        <div class="form-group">
            <label>–ü–∞—Ä–æ–ª—å:</label><br>
            <input type="password" id="loginPassword" value="TestPassword123!" placeholder="TestPassword123!">
        </div>
        <button onclick="testLogin()">–¢–µ—Å—Ç –≤—Ö–æ–¥–∞</button>
        <div id="loginResult" class="log"></div>
    </div>

    <div class="test-section">
        <h3>üë§ –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</h3>
        <button onclick="checkCurrentUser()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</button>
        <div id="currentUserResult" class="log"></div>
    </div>

    <div class="test-section">
        <h3>üö™ –í—ã—Ö–æ–¥</h3>
        <button onclick="testLogout()">–í—ã–π—Ç–∏</button>
        <div id="logoutResult" class="log"></div>
    </div>

    <script>
        let supabase = null;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ–∫—É—â–∏–π URL
        document.getElementById('currentUrl').textContent = window.location.href;

        function log(elementId, message) {
            const element = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString();
            element.textContent += `[${timestamp}] ${message}\n`;
            element.scrollTop = element.scrollHeight;
        }

        async function loadSupabase() {
            const logElement = document.getElementById('sdkStatus');
            logElement.textContent = '';
            
            log(logElement, 'üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º Supabase SDK...');
            
            try {
                // –ü—Ä–æ–±—É–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å SDK
                const script = document.createElement('script');
                script.src = 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2';
                
                await new Promise((resolve, reject) => {
                    script.onload = resolve;
                    script.onerror = reject;
                    document.head.appendChild(script);
                });
                
                log(logElement, '‚úÖ Supabase SDK –∑–∞–≥—Ä—É–∂–µ–Ω');
                
                // –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç
                const supabaseUrl = 'https://xykhpnksatwipwcmxwyn.supabase.co';
                const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh5a2hwbmtzYXR3aXB3Y214d3luIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUyNTAyNjIsImV4cCI6MjA3MDgyNjI2Mn0.PSARsuv14dI7xq35xvgVoxwjptb4cm8Ywb3bYZhY0KM';
                
                supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
                log(logElement, '‚úÖ Supabase –∫–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω');
                
            } catch (error) {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}`);
            }
        }

        async function testRegistration() {
            const logElement = document.getElementById('regResult');
            logElement.textContent = '';
            
            if (!supabase) {
                log(logElement, '‚ùå Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return;
            }
            
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            
            log(logElement, `üîÑ –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${email}`);
            
            try {
                const { data, error } = await supabase.auth.signUp({
                    email: email,
                    password: password
                });
                
                if (error) {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: ${error.message}`);
                } else {
                    log(logElement, '‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞');
                    if (data.user && !data.user.email_confirmed_at) {
                        log(logElement, '‚ö†Ô∏è Email —Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è');
                    }
                }
            } catch (error) {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        async function testLogin() {
            const logElement = document.getElementById('loginResult');
            logElement.textContent = '';
            
            if (!supabase) {
                log(logElement, '‚ùå Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return;
            }
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            log(logElement, `üîÑ –í—Ö–æ–¥–∏–º –≤ —Å–∏—Å—Ç–µ–º—É: ${email}`);
            
            try {
                const { data, error } = await supabase.auth.signInWithPassword({
                    email: email,
                    password: password
                });
                
                if (error) {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: ${error.message}`);
                } else {
                    log(logElement, '‚úÖ –í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                    log(logElement, `üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: ${data.user.email}`);
                }
            } catch (error) {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        async function checkCurrentUser() {
            const logElement = document.getElementById('currentUserResult');
            logElement.textContent = '';
            
            if (!supabase) {
                log(logElement, '‚ùå Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return;
            }
            
            log(logElement, 'üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è...');
            
            try {
                const { data: { user }, error } = await supabase.auth.getUser();
                
                if (error) {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
                } else if (user) {
                    log(logElement, `‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω: ${user.email}`);
                    log(logElement, `üÜî ID: ${user.id}`);
                    log(logElement, `üìÖ –°–æ–∑–¥–∞–Ω: ${user.created_at}`);
                } else {
                    log(logElement, '‚ö†Ô∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
                }
            } catch (error) {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        async function testLogout() {
            const logElement = document.getElementById('logoutResult');
            logElement.textContent = '';
            
            if (!supabase) {
                log(logElement, '‚ùå Supabase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
                return;
            }
            
            log(logElement, 'üîÑ –í—ã—Ö–æ–¥–∏–º –∏–∑ —Å–∏—Å—Ç–µ–º—ã...');
            
            try {
                const { error } = await supabase.auth.signOut();
                
                if (error) {
                    log(logElement, `‚ùå –û—à–∏–±–∫–∞ –≤—ã—Ö–æ–¥–∞: ${error.message}`);
                } else {
                    log(logElement, '‚úÖ –í—ã—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ');
                }
            } catch (error) {
                log(logElement, `‚ùå –û—à–∏–±–∫–∞: ${error.message}`);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', () => {
            setTimeout(() => {
                loadSupabase();
            }, 1000);
        });
    </script>
</body>
</html>
